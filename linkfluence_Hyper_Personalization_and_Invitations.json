{
  "name": "linkfluence_Hyper_Personalization_and_Invitations",
  "nodes": [
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/tasks/download_person_detail ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "=json",
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "jsonBody": "={\n    \"public_identifier\": \"{{ $json.public_identifier }}\",\n       \"set_tags_at_enqueue\":[\"enrichment_enqueued\"],\n    \"set_tags_at_completion\":[\"enrichment_done\"]\n}  ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "291cbb07-e010-4fbc-94be-0ce8189fb870",
      "name": "âš™ï¸ğŸ“¥ Person_Detail",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1416,
        812
      ]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.linkfluence.me/persons/custom_data",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"public_identifier\": \"{{ $('Loop Over Companies').item.json.public_identifier }}\",\n  \"field_name\": \"outreach\",\n  \"value\": {\n    \"sMessage_1\": {{ JSON.stringify($json.message) }}\n  }\n}         ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "ecf43410-81ed-4f1d-97bd-11892dffdfe6",
      "name": "person_set_message",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1992,
        1900
      ]
    },
    {
      "parameters": {
        "content": "## 3. ğŸ™‹â€â™‚ï¸âœï¸ Message creation\nWith the profile enriched, we extract the information we need for our message using LLMs.\nWe store it afterwards in the custom_data block of the Person record and tag it as ready to send. \nYou can check and correct the messages if needed in the database before we enqueue them for send out in Block Nr. 4\n\n### Tags set by the workflow: \n_#c_agent_5_set_message_done_\n",
        "height": 1120.9100485977008,
        "width": 1945.6621214491843,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        440,
        1036
      ],
      "id": "185655bf-5b76-4591-9b11-2d245671b554",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/persons/query",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"filter\": {    \n    \"$and\": [    \t \n         {\"lead_score.tags\": { \"$in\": [\"is Budget owner\"] }},\n      \t {\"lead_score.tags\": { \"$nin\": [\"invitation_enqueued\"] }}\n    ]\n     \n  },\n  \"sort\": {\"lead_score.score\": -1},\n  \"projection\": {\n      \"public_identifier\": 1,\n      \"full_name\": 1,\n      \"data_structured\":1\n  }  \n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "89c1b8ac-38f2-4f62-9f23-90446e37d95b",
      "name": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ‰ 4_invitations",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1192,
        236
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/tasks/send_invites",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"public_identifier\": \"{{ $json.public_identifier }}\",\n    \"set_tags_at_enqueue\":[\"invitation_enqueued\"],\n    \"set_tags_at_completion\":[\"invitation_done\"]\n  }  ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "d5f4b09a-7abf-4434-a751-6321082facdd",
      "name": "âš™ï¸ğŸ‰create_invite",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1384,
        236
      ]
    },
    {
      "parameters": {
        "content": "## 1. âš™ï¸ğŸ‰ Create Invitations Tasks\n- We query for the people who we want to send an invite and we haven't sent an invitation yet.\n- For those an invitation task is then created\n### Tags set by the workflow: \n_#invitation_enqueued_\n_#invitation_done_",
        "height": 275,
        "width": 1220
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        440,
        140
      ],
      "id": "63c3139e-013e-4ea2-8807-075adeb5b87f",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## 2. âš™ï¸ğŸ™‹â€â™‚ï¸ğŸŒ± Create Enrich Person and Companies Task AFTER the invitation was accepted\nWe check periodically if invitations were accepted. If yes we enrich the persons record \nalso the company which the person is working for with the full profile data.\n\n### Tags set by the workflow: \n_#enrichment_enqueued_\n_#enrichment_done_\n",
        "height": 275.43477609530635,
        "width": 1942.6240574853912,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        440,
        700
      ],
      "id": "e8c59bf0-d3d5-41dd-a82c-d4df0d5f7d29",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/persons/query",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"filter\": {    \n     \"$and\": [    \t\n\t    {\"lead_score.tags\": { \"$in\": [\"invitation_done\"] }},\n\t    {\"lead_score.tags\": { \"$nin\": [\"enrichment_enqueued\"] }},\n     \t{\"status.invitation.state\": \"accepted\"}\n    ]\n  },\n  \"projection\": {\n      \"public_identifier\": 1,\n      \"employer\": 1\n  }  \n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "99f163ff-cfd4-46b2-bbb8-e49909ee8a2c",
      "name": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸŒ± 4_enrichment",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1208,
        812
      ]
    },
    {
      "parameters": {
        "content": "## 5. âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸ Create Send Message Task\nIn the last step we check if they were new messages created for send out. \nIf yes we create the responding send message tasks\n### Tags set by the workflow: \n_#c_agent_6_send_message_enq_\n_#c_agent_7_send_message_done_\n",
        "height": 524,
        "width": 660,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        440,
        2220
      ],
      "id": "9da77c24-0471-4cdb-9072-4add4720723f",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/persons/query",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"filter\": {    \n       \"$and\": [\n    \t{\"lead_score.tags\": { \"$in\": [\"set_message_done\"] }},\n   \t    {\"lead_score.tags\": { \"$nin\": [\"send_message_enqued\"] }}\n       ]\n  },\n  \"projection\": {\n      \"public_identifier\": 1,\n      \"full_name\": 1,\n      \"data_structured\":1,\n      \"custom_data\":1\n  }  \n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "4ebd78d3-0021-43a1-b410-a2bfc5bd1e71",
      "name": "ğŸ”ğŸ™‹â€â™‚ï¸âœ‰ï¸ 4_send_message",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        712,
        2540
      ]
    },
    {
      "parameters": {
        "content": "## ![Source example](https://raw.githubusercontent.com/buy-side/photos/main/l4.png)\nThe invitations are sent in the background by the linkfluence platform.\nWhen the invitation is accepted the platform updates the filed status.invitation.state to accepted - so we can pull them in the next step.",
        "height": 157.1453676448048,
        "width": 1933.4549120375327,
        "color": 5
      },
      "id": "968829d9-7aab-4254-bb6b-f0284853f999",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        440,
        476
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/tasks/send_message ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"public_identifier\": \"{{ $json.public_identifier }}\",\n    \"set_tags_at_enqueue\":[\"send_message_enqued\"],\n    \"set_tags_at_completion\":[\"send_message_done\"],\n    \"message_text\": {{ JSON.stringify($json.custom_data.outreach.sMessage_1) }}\n\n}  ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "e160bb10-43fd-4c69-a4ea-54d14a9465cf",
      "name": "âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸send_message1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        904,
        2540
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/tasks/download_company_detail ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"company_id\": \"{{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸŒ± 4_enrichment').item.json.employer.company_id }}\",\n    \"set_tags_at_enqueue\":[\"enrichment_enqueued\"],\n    \"set_tags_at_completion\":[\"enrichment_done\"]\n}    ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "88bd394d-0612-481e-b31c-91186f080f5c",
      "name": "âš™ï¸ğŸ¦ Company_Detail",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1608,
        812
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/persons/query ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"filter\": {         \n    \t\"lead_score.tags\": { \"$in\": [\"is Budget owner\"] },\n\t    \"lead_score.tags\": { \"$nin\": [\"set_message_done\"] }\n  },\n  \"projection\": {\n      \"public_identifier\": 1,\n      \"data\":1,\n      \"employer\": 1\n  }  \n} ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "e2885826-6987-4dc6-bed7-533f1e7b6f6a",
      "name": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_4_message",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        968,
        1212
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/companies/query ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"filter\": {         \n    \t\"company_id\": \"{{ $json.employer.company_id }}\"\n  }  \n}  ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "048d764f-ca10-48ab-aed5-8244478606e0",
      "name": "ğŸ”ğŸ¦  employer_info",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        968,
        1452
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "5d53a1cc-5a6b-4d60-817a-2126326924ab",
              "name": "sOpening_Line",
              "value": "={{ $json.message.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "a0c553ec-3775-4d95-acb2-17fe3c414f0d",
      "name": "Opening_Line",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1528,
        1452
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "59177d35-623f-4bd8-940f-198a894e8aa0",
              "name": "sICP",
              "value": "={{ $json.message.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "a15e3e9d-f9f2-4368-8982-e6c3025caef3",
      "name": "ICP",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1528,
        1676
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "bebc9381-2c3b-4632-9b31-5c09160b5556",
              "name": "sCompany_Name",
              "value": "={{ $json.message.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "70f1250c-c3f0-46fd-bd46-cd5991db8e3e",
      "name": "Company_Name",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1528,
        1900
      ]
    },
    {
      "parameters": {
        "jsCode": "return items.map((item, idx) => {\n  // Vorherige Werte holen\n  const sFirst_Name = $item(idx).$node[\"Clean_First_Name\"].json.sFirst_Name;\n  const sCompany_Name = $item(idx).$node[\"Company_Name\"].json.sCompany_Name;\n  const sICP = $item(idx).$node[\"ICP\"].json.sICP;\n  const sOpening_Line = $item(idx).$node[\"Opening_Line\"].json.sOpening_Line;\n  const sReference_Group = $item(idx).$node[\"Reference_Group\"].json.sReference_Group;\n\n  // Message bauen\n  const message = `Hey ${sFirst_Name}, \n${sOpening_Line}\n\nI'm reaching out because I can help you connect more effectively with ${sICP}.\n\nGiven how active you and ${sCompany_Name} are on LinkedIn, I believe\nscaling your LinkedIn strategy with our AI-Agents might be interesting for you.\nWe run them as a managed service with success-based pricing, designed for\ngrowing companies that need big results without big budgets.\n\nI'd be happy to share a quick case study of how we helped another\n${sReference_Group} increase their LinkedIn engagement by 300%.\n\nWorth a 15-minute call?\n\nBR Stefan`;\n\n  // Ergebnis ins Item schreiben â†’ wird in den nÃ¤chsten Nodes verfÃ¼gbar\n  item.json.message = message;\n\n  return item;\n});\n"
      },
      "id": "d1118ef1-d96a-4622-961f-d1eb2cd53baf",
      "name": "Message_Builder",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1784,
        1900
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "dd7b2b82-db2c-4249-9d6e-01636dd17ea5",
              "name": "sFirst_Name",
              "value": "={{ $json.message.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "a20f4958-d254-4645-97cd-f2e7905a30bf",
      "name": "Clean_First_Name",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        2184,
        1452
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "163cb796-02c8-4991-9cca-a3a0ba8b9072",
              "name": "sReference_Group",
              "value": "={{ $json.message.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "5ece8a00-161b-4b55-9727-c1e9a37e45f9",
      "name": "Reference_Group",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        2184,
        1676
      ]
    },
    {
      "parameters": {
        "content": "## 4. âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸ Human in the Loop \nExplenation [Video on how to connect n8n with google sheets](https://www.youtube.com/watch?v=pWGXlZBGu4k)\n",
        "height": 526,
        "width": 1265,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1128,
        2220
      ],
      "id": "6a8628c5-79b8-45bd-91e5-fc78578f171a",
      "name": "Sticky Note13"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/persons/query ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"filter\": {         \n    \"$and\": [   \n        {\"lead_score.tags\": { \"$in\": [\"is Budget owner\"] }},\n\t    {\"lead_score.tags\": { \"$in\": [\"set_message_done\"] }},\n        {\"lead_score.tags\": { \"$nin\": [\"send_message_approved\"] }}\n     ]\n  },\n  \"projection\": {\n      \"public_identifier\": 1,\n      \"custom_data\": 1,\n      \"data\":1,\n      \"employer\": 1\n  }  \n} ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "9b0fbe0f-f823-4f2e-981f-1f69417b25f0",
      "name": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1592,
        2332
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/companies/query ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"filter\": {         \n    \t\"company_id\": \"{{ $json.employer.company_id }}\"\n  },\n  \"projection\": {\n      \"data_enriched\": 1\n  }  \n}   ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "a3879cc2-cc69-448f-b955-b323693b2612",
      "name": "ğŸ”ğŸ¦  employer_info_check",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1784,
        2332
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY",
          "mode": "list",
          "cachedResultName": "n8n_output",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 672618695,
          "mode": "list",
          "cachedResultName": "messages",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit#gid=672618695"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "approved",
              "lookupValue": "x"
            }
          ]
        },
        "options": {
          "returnAllMatches": "returnAllMatches"
        }
      },
      "id": "ee0b7ef9-9d65-45fe-844d-1e3b42f6a4ec",
      "name": "get approved messages",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.3,
      "position": [
        1400,
        2540
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY",
          "mode": "list",
          "cachedResultName": "n8n_output",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 672618695,
          "mode": "list",
          "cachedResultName": "messages",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit#gid=672618695"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "public_identifier": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.public_identifier }}",
            "first_name": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.data.first_name }}",
            "last_name": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.data.last_name }}",
            "headline": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.data.headline }}",
            "company_id": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.employer.company_id }}",
            "universal_name": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.employer.universal_name }}",
            "company_summary": "={{ $json.data_enriched.company_summary }}",
            "message": "={{ $('ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check').item.json.custom_data.outreach.sMessage_1 }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "public_identifier",
              "displayName": "public_identifier",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "first_name",
              "displayName": "first_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "last_name",
              "displayName": "last_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "headline",
              "displayName": "headline",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "company_id",
              "displayName": "company_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "universal_name",
              "displayName": "universal_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "company_summary",
              "displayName": "company_summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "message",
              "displayName": "message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "fc75a700-882b-48d8-964e-f1b7dba11a6e",
      "name": "export messages",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.3,
      "position": [
        1992,
        2332
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.linkfluence.me/tasks/send_message ",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"public_identifier\": \"{{ $json.public_identifier }}\",\n        \"set_tags_at_enqueue\":[\"send_message_enqueued\"],\n    \"set_tags_at_completion\":[\"send_message_done\"],\n    \"message_text\": {{ JSON.stringify($json.message) }}\n}  ",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "id": "4551baed-cda0-4471-bb4d-b99290fdb847",
      "name": "âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸send_approved_messages",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1784,
        2540
      ]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.linkfluence.me/persons/tags/add",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"public_identifier\": \"{{ $('Loop Over Companies').item.json.public_identifier }}\",\n  \"tags\": [\"set_message_done\"]  \n}    ",
        "options": {}
      },
      "id": "2515f12b-9293-4ac2-aa78-cbe0f9b66d1f",
      "name": "person_set_tag",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2184,
        1900
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "GPT-4.1"
        },
        "messages": {
          "values": [
            {
              "content": "=Write a natural-sounding, humanized opening sentence for a LinkedIn message.\n       \nTone: Friendly and professional.  \nGoal: Start a conversation naturally without sounding scripted.  \nLength: Keep it under 30 words.  \n    \nMake it relevant to them (e.g., referencing their product, USP, target market, or a recent milestone).\nAvoid generic statements - make it feel like it was written just for them.\nNEVER mention company name in sentence.\nDO NOT include any personal names or greetings in the opening line.\n    \nImportant:\nOutput only the clean opening_line, with no explanation or formatting. \n\n---\nRecipient:\n- Company Description: \n {{ $json.data_enriched.company_summary }}"
            }
          ]
        },
        "options": {}
      },
      "id": "4f9be0ac-493e-4ecc-ad1d-62c56a8a0ec8",
      "name": "Generate Opening Line",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [
        1160,
        1452
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "GPT-4.1"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a B2B growth strategist helping with LinkedIn cold outreach.\n\nGiven the following **company summary**, extract exactly **one ideal customer profile (ICP)** that this company likely wants to connect with.\n\nThe ICP must:\n- Be **precise** (e.g. include company types, roles, or titles),\n- Be **humanized** (feel natural and real),\n- Be a **maximum of 10 words**,\n- Be formatted to fit into the sentence: \"I'm reaching out because I can help you connect more effectively with {{ICP}}.\"\n\n\nImportant:\nOutput only your extracted ICP that fits the sentence format, with no explanation or formatting. \n\n\n---\n**Company Summary:**\n {{ $('ğŸ”ğŸ¦  employer_info').item.json.data_enriched.company_summary }}"
            }
          ]
        },
        "options": {}
      },
      "id": "ff7e6611-e77b-4280-8fd6-18d9f7682d94",
      "name": "Generate ICP",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [
        1160,
        1676
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "GPT-4.1"
        },
        "messages": {
          "values": [
            {
              "content": "=Your task is to reduce the provided company name to the core term that employees or customers would naturally use when referring to the company.\nRemove unnecessary elements such as 'LLC', 'GmbH', 'Inc.', 'AG', or 'Ltd.' and avoid additional formalities like 'and Co' or similar suffixes. \nEnsure the name is concise, informal, and aligns with how people inside or outside the organization would refer to it in day-to-day conversations.\n\nHere is the company name to clean: {{ $('ğŸ”ğŸ¦  employer_info').item.json.company_name }}\n\nImportant:\nOutput only the the clean version of the company name, with no explanation or formatting. \n "
            }
          ]
        },
        "options": {}
      },
      "id": "f10abfc1-c162-40ea-8e3c-c1bc5a824125",
      "name": "Clean Company Name",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [
        1160,
        1900
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-3.5-turbo",
          "mode": "list",
          "cachedResultName": "GPT-3.5-TURBO"
        },
        "messages": {
          "values": [
            {
              "content": "=Your task is to extract only the first name from the full name provided below.\nIgnore all titles (e.g. 'Dr.', 'Prof.', 'Ph.D.', 'MBA', 'CFA', etc.), degrees, honorifics, initials, emojis,\ncontents in brackets or parentheses, and anything after a comma.\nReturn only the name that the person would be called in a casual conversation or email greeting.\n\nHere is the full name: \"{{ $('Loop Over Companies').item.json.data.first_name }}\"\n\nNotes:\nOutput only the clean first name, with no explanation or formatting.  "
            }
          ]
        },
        "options": {}
      },
      "id": "b29c3fed-fa27-4871-ae3e-1f803bac66b8",
      "name": "Get First Name Clean",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [
        1784,
        1452
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4",
          "mode": "list",
          "cachedResultName": "GPT-4"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a B2B growth strategist helping with LinkedIn cold outreach.\n\nGiven the following **company summary**, extract exactly **one reference group** that this company fits in.\n\nThe reference group must:\n- Be **a bit more general** (e.g. engineering company, software company, it service company, consulting company...),\n- Be a **maximum of 3 words**,\n- Be **fit for the company's industry**,\n- Be **humanized** (feel natural and real),\n- Be formatted to fit into the sentence:\n  \"I'd be happy to share a quick case study of how we helped another (your reference group) increase their LinkedIn engagement by 300%.\"\n\n\nNotes:\nOutput only the clean extracted reference group, with no explanation or formatting. \n\n---\n**Company Summary:**\n{{ $('ğŸ”ğŸ¦  employer_info').item.json.data_enriched.company_summary }}"
            }
          ]
        },
        "options": {}
      },
      "id": "6b9aeec8-0ae1-441f-bcb3-f116ececa011",
      "name": "Get Reference Group",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [
        1784,
        1676
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "id": "f70cc0d4-d922-451f-9080-6f12beae5e8c",
      "name": "Invitations_Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        984,
        236
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "id": "216986eb-d42a-4074-9322-c7a96efc2ec9",
      "name": "Enricht_Person_Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        984,
        812
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "id": "0f2a9100-d115-4608-82ed-c30ee9d2fb6c",
      "name": "Create_Message_Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        760,
        1212
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 10
            }
          ]
        }
      },
      "id": "2d38beee-c5a7-43dd-a8ff-7985de07d160",
      "name": "Send_Message_Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        504,
        2540
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 10
            }
          ]
        }
      },
      "id": "fe46ba14-2dfa-450a-8c50-cb87564774fc",
      "name": "Push_Messages_for_Review",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        1192,
        2332
      ]
    },
    {
      "parameters": {
        "content": "## ğŸ‘‰ğŸš€ Before you start -> Helpful Videos & Links\n- How to connect n8n to Linkedin with linkfluence [video](https://youtu.be/LXem2fEDtSM?si=O8PDpjEZN2YOFT5l)\n- How to download and score companies & people from Linkedin to linkfluence\n - ğŸ¦ Downloading [Companies](https://youtu.be/VH2WvhQDGv0?si=zba2fC00l36h7i1B)\n - ğŸ™‹â€â™‚ï¸ Downloading [People](https://youtu.be/RJEJZuXYToI?si=HY5vEfD8n8POJVih)\n\n## ğŸ’¬ You have a question?\n- Post it on the wall in our [skool community](https://www.skool.com/linkfluence-8931/about?ref=c93854354ebc46349128d4f6c0155d15)\n- Or write a mail to support@linkfluence.app",
        "height": 275,
        "width": 676,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1688,
        140
      ],
      "id": "967b602f-4530-487a-8681-0d6041183c2d",
      "name": "Sticky Note15"
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "row_number",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.sort",
      "typeVersion": 1,
      "position": [
        1592,
        2540
      ],
      "id": "80b1ea04-cda2-4711-a561-fb0137752d22",
      "name": "Sort"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 10
            }
          ]
        }
      },
      "id": "cbbeda8b-cea8-4a51-a8dc-470f922ce2b1",
      "name": "Send_Approved",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        1192,
        2540
      ]
    },
    {
      "parameters": {
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY",
          "mode": "list",
          "cachedResultName": "n8n_output",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 672618695,
          "mode": "list",
          "cachedResultName": "messages",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit#gid=672618695"
        },
        "clear": "specificRange",
        "range": "A2:R1000"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1400,
        2332
      ],
      "id": "2bb7e063-e4d2-4a08-a2a1-c6b7ac6b8189",
      "name": "Clear sheet",
      "credentials": {}
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "3a2e5145-5147-407e-be26-adc192a905cb",
      "name": "Loop Over Companies",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        760,
        1436
      ]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.linkfluence.me/persons/tags/add",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"public_identifier\": \"{{ $('get approved messages').item.json.public_identifier }}\",\n  \"tags\": [\"send_message_approved\"]  \n}    ",
        "options": {}
      },
      "id": "88219836-6882-47a2-b18c-e83abf13ae2d",
      "name": "set_tag_message_approved",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1992,
        2540
      ]
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY",
          "mode": "list",
          "cachedResultName": "n8n_output",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 672618695,
          "mode": "list",
          "cachedResultName": "messages",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1e8efi0vDEeEO4MpLD0hBxLqwzjnoe-QT-TT7X1UvyDY/edit#gid=672618695"
        },
        "startIndex": "={{ $('Sort').item.json.row_number }}"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2200,
        2540
      ],
      "id": "be95d162-1680-461a-aeb5-e3a4b7d3b23b",
      "name": "Delete rows from sheet",
      "credentials": {}
    },
    {
      "parameters": {
        "content": "## ![Source example](https://raw.githubusercontent.com/buy-side/photos/main/l4.png)\nLinkfluence sends the enqueued messages via your LinkedIn account in the background.",
        "height": 157,
        "width": 1949,
        "color": 5
      },
      "id": "e4e49138-72b7-4a0c-941c-0cc102756c7b",
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        440,
        2796
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "person_set_message": {
      "main": [
        [
          {
            "node": "person_set_tag",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ‰ 4_invitations": {
      "main": [
        [
          {
            "node": "âš™ï¸ğŸ‰create_invite",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ™‹â€â™‚ï¸âœ‰ï¸ 4_send_message": {
      "main": [
        [
          {
            "node": "âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸send_message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ™‹â€â™‚ï¸ğŸŒ± 4_enrichment": {
      "main": [
        [
          {
            "node": "âš™ï¸ğŸ“¥ Person_Detail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_4_message": {
      "main": [
        [
          {
            "node": "Loop Over Companies",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ¦  employer_info": {
      "main": [
        [
          {
            "node": "Generate Opening Line",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Opening_Line": {
      "main": [
        [
          {
            "node": "Generate ICP",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ICP": {
      "main": [
        [
          {
            "node": "Clean Company Name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Company_Name": {
      "main": [
        [
          {
            "node": "Get First Name Clean",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clean_First_Name": {
      "main": [
        [
          {
            "node": "Get Reference Group",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reference_Group": {
      "main": [
        [
          {
            "node": "Message_Builder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message_Builder": {
      "main": [
        [
          {
            "node": "person_set_message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check": {
      "main": [
        [
          {
            "node": "ğŸ”ğŸ¦  employer_info_check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”ğŸ¦  employer_info_check": {
      "main": [
        [
          {
            "node": "export messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get approved messages": {
      "main": [
        [
          {
            "node": "Sort",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "person_set_tag": {
      "main": [
        [
          {
            "node": "Loop Over Companies",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Opening Line": {
      "main": [
        [
          {
            "node": "Opening_Line",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate ICP": {
      "main": [
        [
          {
            "node": "ICP",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clean Company Name": {
      "main": [
        [
          {
            "node": "Company_Name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get First Name Clean": {
      "main": [
        [
          {
            "node": "Clean_First_Name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Reference Group": {
      "main": [
        [
          {
            "node": "Reference_Group",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš™ï¸ğŸ“¥ Person_Detail": {
      "main": [
        [
          {
            "node": "âš™ï¸ğŸ¦ Company_Detail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Invitations_Trigger": {
      "main": [
        [
          {
            "node": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ‰ 4_invitations",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enricht_Person_Trigger": {
      "main": [
        [
          {
            "node": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸŒ± 4_enrichment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create_Message_Trigger": {
      "main": [
        [
          {
            "node": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_4_message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send_Message_Trigger": {
      "main": [
        [
          {
            "node": "ğŸ”ğŸ™‹â€â™‚ï¸âœ‰ï¸ 4_send_message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Push_Messages_for_Review": {
      "main": [
        [
          {
            "node": "Clear sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸send_approved_messages": {
      "main": [
        [
          {
            "node": "set_tag_message_approved",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort": {
      "main": [
        [
          {
            "node": "âš™ï¸ğŸ™‹â€â™‚ï¸âœ‰ï¸send_approved_messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send_Approved": {
      "main": [
        [
          {
            "node": "get approved messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clear sheet": {
      "main": [
        [
          {
            "node": "ğŸ”ğŸ™‹â€â™‚ï¸ğŸ’Œ people_message_check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Companies": {
      "main": [
        [],
        [
          {
            "node": "ğŸ”ğŸ¦  employer_info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "set_tag_message_approved": {
      "main": [
        [
          {
            "node": "Delete rows from sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "fc2a13bc-b6ef-47be-acfc-fce57876a5a6",
  "meta": {
    "instanceId": "1fa85c4d1a08fc87e14438ac5df9c6b0197a2cb7066fb3dbdaf34a974db55ab9"
  },
  "id": "0MskSb0xgSHiEpuv",
  "tags": []
}
